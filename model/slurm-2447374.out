[2025-04-29 19:06:22,974] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-04-29 19:06:32,436] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
[2025-04-29 19:06:32,441] [INFO] [real_accelerator.py:239:get_accelerator] Setting ds_accelerator to cuda (auto detect)
CUDA_VISIBLE_DEVICES: 0,1
CUDA device count: 2
CUDA current device: 0
CUDA device name: Tesla V100-PCIE-32GB
CUDA_VISIBLE_DEVICES: 0,1
CUDA device count: 2
CUDA current device: 0
CUDA device name: Tesla V100-PCIE-32GB
/home/ms1438/.conda/envs/venv/lib/python3.12/site-packages/accelerate/accelerator.py:249: FutureWarning: `logging_dir` is deprecated and will be removed in version 0.18.0 of ðŸ¤— Accelerate. Use `project_dir` instead.
  warnings.warn(
/home/ms1438/.conda/envs/venv/lib/python3.12/site-packages/accelerate/accelerator.py:249: FutureWarning: `logging_dir` is deprecated and will be removed in version 0.18.0 of ðŸ¤— Accelerate. Use `project_dir` instead.
  warnings.warn(
/home/ms1438/.conda/envs/venv/lib/python3.12/site-packages/accelerate/accelerator.py:416: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.scaler = torch.cuda.amp.GradScaler(**kwargs)
04/29/2025 19:06:37 - INFO - __main__ - Distributed environment: DistributedType.MULTI_GPU  Backend: nccl
Num processes: 2
Process index: 0
Local process index: 0
Device: cuda:0

Mixed precision type: fp16

/home/ms1438/.conda/envs/venv/lib/python3.12/site-packages/accelerate/accelerator.py:416: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  self.scaler = torch.cuda.amp.GradScaler(**kwargs)
04/29/2025 19:06:37 - INFO - __main__ - Distributed environment: DistributedType.MULTI_GPU  Backend: nccl
Num processes: 2
Process index: 1
Local process index: 1
Device: cuda:1

Mixed precision type: fp16

[rank1]:[W429 19:06:37.530420952 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 1]  using GPU 1 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Tracking run with wandb version 0.19.0
wandb: W&B syncing is set to `offline` in this directory.  
wandb: Run `wandb online` or set WANDB_MODE=online to enable cloud syncing.
[rank0]:[W429 19:06:38.187243339 ProcessGroupNCCL.cpp:4115] [PG ID 0 PG GUID 0 Rank 0]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect.Specify device_ids in barrier() to force use of a particular device,or call init_process_group() with a device_id.
You are using the default legacy behaviour of the <class 'transformers.models.t5.tokenization_t5.T5Tokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
You are using the default legacy behaviour of the <class 'transformers.models.t5.tokenization_t5.T5Tokenizer'>. This is expected, and simply means that the `legacy` (previous) behavior will be used so nothing changes for you. If you want to use the new behaviour, set `legacy=False`. This should only be set if you understand what it means, and thoroughly read the reason why this was added as explained in https://github.com/huggingface/transformers/pull/24565
Length of dataset:  1683
/home/ms1438/.conda/envs/venv/lib/python3.12/site-packages/torch/utils/data/dataloader.py:617: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
Length of dataset:  1683
/home/ms1438/.conda/envs/venv/lib/python3.12/site-packages/torch/utils/data/dataloader.py:617: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(
Total number of trainable parameters: 114223628
num_update_steps_per_epoch 53
max_train_steps None
max_train_steps 7420
Total number of trainable parameters: 114223628
num_update_steps_per_epoch 53
max_train_steps None
max_train_steps 7420
/home/ms1438/.conda/envs/venv/lib/python3.12/site-packages/accelerate/accelerator.py:1235: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  model.forward = torch.cuda.amp.autocast(dtype=torch.float16)(model.forward)
04/29/2025 19:06:40 - INFO - __main__ - ***** Running training *****
04/29/2025 19:06:40 - INFO - __main__ -   Num examples = 1683
04/29/2025 19:06:40 - INFO - __main__ -   Num Epochs = 140
04/29/2025 19:06:40 - INFO - __main__ -   Instantaneous batch size per device = 8
04/29/2025 19:06:40 - INFO - __main__ -   Total train batch size (w. parallel, distributed & accumulation) = 64
04/29/2025 19:06:40 - INFO - __main__ -   Gradient Accumulation steps = 4
04/29/2025 19:06:40 - INFO - __main__ -   Total optimization steps = 7420
/home/ms1438/.conda/envs/venv/lib/python3.12/site-packages/accelerate/accelerator.py:1235: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  model.forward = torch.cuda.amp.autocast(dtype=torch.float16)(model.forward)
  0%|          | 0/7420 [00:00<?, ?it/s][rank0]:[W429 19:07:04.976585721 reducer.cpp:1400] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
[rank1]:[W429 19:07:04.126642663 reducer.cpp:1400] Warning: find_unused_parameters=True was specified in DDP constructor, but did not find any unused parameters in the forward pass. This flag results in an extra traversal of the autograd graph every iteration,  which can adversely affect performance. If your model indeed never has any unused parameters in the forward pass, consider turning this flag off. Note that this warning may be a false positive if your model has flow control causing later iterations to have unused parameters. (function operator())
  0%|          | 0/7420 [00:24<?, ?it/s, Loss=6.84]  0%|          | 1/7420 [00:24<49:53:15, 24.21s/it, Loss=6.84]  0%|          | 1/7420 [00:32<49:53:15, 24.21s/it, Loss=6.84]  0%|          | 2/7420 [00:32<30:13:32, 14.67s/it, Loss=6.84]  0%|          | 2/7420 [00:40<30:13:32, 14.67s/it, Loss=6.88]  0%|          | 3/7420 [00:40<24:26:28, 11.86s/it, Loss=6.88]  0%|          | 3/7420 [00:48<24:26:28, 11.86s/it, Loss=6.86]  0%|          | 4/7420 [00:48<21:16:13, 10.33s/it, Loss=6.86]  0%|          | 4/7420 [00:55<21:16:13, 10.33s/it, Loss=7.02]  0%|          | 5/7420 [00:55<18:49:48,  9.14s/it, Loss=7.02]  0%|          | 5/7420 [01:04<18:49:48,  9.14s/it, Loss=6.87]  0%|          | 6/7420 [01:04<18:21:08,  8.91s/it, Loss=6.87]  0%|          | 6/7420 [01:12<18:21:08,  8.91s/it, Loss=6.97]  0%|          | 7/7420 [01:12<17:49:31,  8.66s/it, Loss=6.97]  0%|          | 7/7420 [01:20<17:49:31,  8.66s/it, Loss=6.79]  0%|          | 8/7420 [01:20<17:21:28,  8.43s/it, Loss=6.79]  0%|          | 8/7420 [01:28<17:21:28,  8.43s/it, Loss=6.96]  0%|          | 9/7420 [01:28<17:08:07,  8.32s/it, Loss=6.96]  0%|          | 9/7420 [01:35<17:08:07,  8.32s/it, Loss=6.88]  0%|          | 10/7420 [01:35<16:04:41,  7.81s/it, Loss=6.88]  0%|          | 10/7420 [01:42<16:04:41,  7.81s/it, Loss=7.06]  0%|          | 11/7420 [01:42<16:03:47,  7.81s/it, Loss=7.06]  0%|          | 11/7420 [01:50<16:03:47,  7.81s/it, Loss=6.98]  0%|          | 12/7420 [01:50<16:10:08,  7.86s/it, Loss=6.98]  0%|          | 12/7420 [01:58<16:10:08,  7.86s/it, Loss=6.8]   0%|          | 13/7420 [01:58<16:07:29,  7.84s/it, Loss=6.8]  0%|          | 13/7420 [02:06<16:07:29,  7.84s/it, Loss=6.96]  0%|          | 14/7420 [02:06<16:21:27,  7.95s/it, Loss=6.96]  0%|          | 14/7420 [02:15<16:21:27,  7.95s/it, Loss=6.69]  0%|          | 15/7420 [02:15<17:05:02,  8.31s/it, Loss=6.69]  0%|          | 15/7420 [02:23<17:05:02,  8.31s/it, Loss=6.72]  0%|          | 16/7420 [02:23<16:32:36,  8.04s/it, Loss=6.72]  0%|          | 16/7420 [02:31<16:32:36,  8.04s/it, Loss=6.95]  0%|          | 17/7420 [02:31<16:38:02,  8.09s/it, Loss=6.95]  0%|          | 17/7420 [02:38<16:38:02,  8.09s/it, Loss=6.99]  0%|          | 18/7420 [02:38<16:13:13,  7.89s/it, Loss=6.99]  0%|          | 18/7420 [02:46<16:13:13,  7.89s/it, Loss=6.76]  0%|          | 19/7420 [02:46<16:14:43,  7.90s/it, Loss=6.76]  0%|          | 19/7420 [02:55<16:14:43,  7.90s/it, Loss=6.83]  0%|          | 20/7420 [02:55<16:29:19,  8.02s/it, Loss=6.83]  0%|          | 20/7420 [03:02<16:29:19,  8.02s/it, Loss=6.9]   0%|          | 21/7420 [03:02<16:08:58,  7.86s/it, Loss=6.9]  0%|          | 21/7420 [03:10<16:08:58,  7.86s/it, Loss=7.03]  0%|          | 22/7420 [03:10<16:07:41,  7.85s/it, Loss=7.03]  0%|          | 22/7420 [03:19<16:07:41,  7.85s/it, Loss=7.01]  0%|          | 23/7420 [03:19<16:31:32,  8.04s/it, Loss=7.01]  0%|          | 23/7420 [03:27<16:31:32,  8.04s/it, Loss=6.86]  0%|          | 24/7420 [03:27<16:29:18,  8.03s/it, Loss=6.86]  0%|          | 24/7420 [03:32<16:29:18,  8.03s/it, Loss=6.97]  0%|          | 25/7420 [03:32<14:38:30,  7.13s/it, Loss=6.97]  0%|          | 25/7420 [03:37<14:38:30,  7.13s/it, Loss=6.72]  0%|          | 26/7420 [03:37<13:20:04,  6.49s/it, Loss=6.72]  0%|          | 26/7420 [03:38<13:20:04,  6.49s/it, Loss=6.93]  0%|          | 27/7420 [03:38<10:14:18,  4.99s/it, Loss=6.93]Epoch: 68, Loss Train: 6.8427

04/29/2025 19:10:19 - INFO - __main__ - {'epoch': 69, 'step': 27, 'train_loss': 6.8427}
04/29/2025 19:10:19 - INFO - accelerate.accelerator - Saving current state to /scratch/network/ms1438/output_test_new/epoch_69
04/29/2025 19:10:21 - INFO - accelerate.checkpointing - Model weights saved in /scratch/network/ms1438/output_test_new/epoch_69/pytorch_model.bin
04/29/2025 19:10:23 - INFO - accelerate.checkpointing - Optimizer state saved in /scratch/network/ms1438/output_test_new/epoch_69/optimizer.bin
04/29/2025 19:10:23 - INFO - accelerate.checkpointing - Scheduler state saved in /scratch/network/ms1438/output_test_new/epoch_69/scheduler.bin
04/29/2025 19:10:23 - INFO - accelerate.checkpointing - Gradient scaler state saved in /scratch/network/ms1438/output_test_new/epoch_69/scaler.pt
04/29/2025 19:10:23 - INFO - accelerate.checkpointing - Random states saved in /scratch/network/ms1438/output_test_new/epoch_69/random_states_0.pkl
  0%|          | 27/7420 [04:06<10:14:18,  4.99s/it, Loss=6.59]  0%|          | 28/7420 [04:06<24:31:25, 11.94s/it, Loss=6.59]  0%|          | 28/7420 [04:14<24:31:25, 11.94s/it, Loss=6.8]   0%|          | 29/7420 [04:14<22:00:11, 10.72s/it, Loss=6.8]  0%|          | 29/7420 [04:22<22:00:11, 10.72s/it, Loss=6.67]  0%|          | 30/7420 [04:22<20:20:56,  9.91s/it, Loss=6.67]  0%|          | 30/7420 [04:30<20:20:56,  9.91s/it, Loss=6.89]  0%|          | 31/7420 [04:30<19:14:00,  9.37s/it, Loss=6.89]  0%|          | 31/7420 [04:38<19:14:00,  9.37s/it, Loss=6.76]  0%|          | 32/7420 [04:38<18:09:57,  8.85s/it, Loss=6.76]  0%|          | 32/7420 [04:45<18:09:57,  8.85s/it, Loss=6.84]  0%|          | 33/7420 [04:45<17:20:41,  8.45s/it, Loss=6.84]  0%|          | 33/7420 [04:53<17:20:41,  8.45s/it, Loss=6.61]  0%|          | 34/7420 [04:53<17:09:07,  8.36s/it, Loss=6.61]  0%|          | 34/7420 [05:01<17:09:07,  8.36s/it, Loss=6.61]  0%|          | 35/7420 [05:01<16:37:13,  8.10s/it, Loss=6.61]  0%|          | 35/7420 [05:09<16:37:13,  8.10s/it, Loss=6.66]  0%|          | 36/7420 [05:09<16:21:40,  7.98s/it, Loss=6.66]  0%|          | 36/7420 [05:17<16:21:40,  7.98s/it, Loss=6.87]  0%|          | 37/7420 [05:17<16:17:01,  7.94s/it, Loss=6.87]  0%|          | 37/7420 [05:25<16:17:01,  7.94s/it, Loss=6.8]   1%|          | 38/7420 [05:25<16:18:21,  7.95s/it, Loss=6.8]  1%|          | 38/7420 [05:32<16:18:21,  7.95s/it, Loss=6.24]  1%|          | 39/7420 [05:32<16:10:21,  7.89s/it, Loss=6.24]  1%|          | 39/7420 [05:40<16:10:21,  7.89s/it, Loss=6.75]  1%|          | 40/7420 [05:40<15:55:43,  7.77s/it, Loss=6.75]  1%|          | 40/7420 [05:50<15:55:43,  7.77s/it, Loss=6.8]   1%|          | 41/7420 [05:50<17:33:33,  8.57s/it, Loss=6.8]  1%|          | 41/7420 [05:58<17:33:33,  8.57s/it, Loss=6.71]  1%|          | 42/7420 [05:58<17:13:08,  8.40s/it, Loss=6.71]  1%|          | 42/7420 [06:06<17:13:08,  8.40s/it, Loss=6.76]  1%|          | 43/7420 [06:06<16:46:22,  8.19s/it, Loss=6.76]  1%|          | 43/7420 [06:14<16:46:22,  8.19s/it, Loss=6.67]  1%|          | 44/7420 [06:14<16:32:14,  8.07s/it, Loss=6.67]  1%|          | 44/7420 [06:21<16:32:14,  8.07s/it, Loss=6.79]  1%|          | 45/7420 [06:21<16:20:03,  7.97s/it, Loss=6.79]  1%|          | 45/7420 [06:29<16:20:03,  7.97s/it, Loss=6.42]  1%|          | 46/7420 [06:29<15:59:16,  7.81s/it, Loss=6.42]  1%|          | 46/7420 [06:37<15:59:16,  7.81s/it, Loss=6.84]  1%|          | 47/7420 [06:37<16:04:40,  7.85s/it, Loss=6.84]  1%|          | 47/7420 [06:45<16:04:40,  7.85s/it, Loss=6.66]  1%|          | 48/7420 [06:45<16:02:05,  7.83s/it, Loss=6.66]  1%|          | 48/7420 [06:53<16:02:05,  7.83s/it, Loss=6.66]  1%|          | 49/7420 [06:53<16:13:52,  7.93s/it, Loss=6.66]  1%|          | 49/7420 [07:01<16:13:52,  7.93s/it, Loss=6.8]   1%|          | 50/7420 [07:01<16:24:03,  8.01s/it, Loss=6.8]  1%|          | 50/7420 [07:09<16:24:03,  8.01s/it, Loss=6.73]  1%|          | 51/7420 [07:09<16:26:07,  8.03s/it, Loss=6.73]  1%|          | 51/7420 [07:14<16:26:07,  8.03s/it, Loss=6.73]  1%|          | 52/7420 [07:14<14:36:58,  7.14s/it, Loss=6.73]  1%|          | 52/7420 [07:19<14:36:58,  7.14s/it, Loss=6.71]  1%|          | 53/7420 [07:19<13:19:43,  6.51s/it, Loss=6.71]  1%|          | 53/7420 [07:21<13:19:43,  6.51s/it, Loss=6.77]  1%|          | 54/7420 [07:21<10:15:05,  5.01s/it, Loss=6.77]Epoch: 69, Loss Train: 6.6982

04/29/2025 19:14:01 - INFO - __main__ - {'epoch': 70, 'step': 54, 'train_loss': 6.6982}
04/29/2025 19:14:01 - INFO - accelerate.accelerator - Saving current state to /scratch/network/ms1438/output_test_new/epoch_70
04/29/2025 19:14:03 - INFO - accelerate.checkpointing - Model weights saved in /scratch/network/ms1438/output_test_new/epoch_70/pytorch_model.bin
04/29/2025 19:14:06 - INFO - accelerate.checkpointing - Optimizer state saved in /scratch/network/ms1438/output_test_new/epoch_70/optimizer.bin
04/29/2025 19:14:06 - INFO - accelerate.checkpointing - Scheduler state saved in /scratch/network/ms1438/output_test_new/epoch_70/scheduler.bin
04/29/2025 19:14:06 - INFO - accelerate.checkpointing - Gradient scaler state saved in /scratch/network/ms1438/output_test_new/epoch_70/scaler.pt
04/29/2025 19:14:06 - INFO - accelerate.checkpointing - Random states saved in /scratch/network/ms1438/output_test_new/epoch_70/random_states_0.pkl
  1%|          | 54/7420 [07:48<10:15:05,  5.01s/it, Loss=6.52]  1%|          | 55/7420 [07:48<23:50:41, 11.66s/it, Loss=6.52]  1%|          | 55/7420 [07:55<23:50:41, 11.66s/it, Loss=5.97]  1%|          | 56/7420 [07:55<21:22:58, 10.45s/it, Loss=5.97]  1%|          | 56/7420 [08:03<21:22:58, 10.45s/it, Loss=6.66]  1%|          | 57/7420 [08:03<19:34:56,  9.57s/it, Loss=6.66]  1%|          | 57/7420 [08:10<19:34:56,  9.57s/it, Loss=6.59]  1%|          | 58/7420 [08:10<18:18:01,  8.95s/it, Loss=6.59]  1%|          | 58/7420 [08:18<18:18:01,  8.95s/it, Loss=6.37]  1%|          | 59/7420 [08:18<17:34:37,  8.60s/it, Loss=6.37]  1%|          | 59/7420 [08:26<17:34:37,  8.60s/it, Loss=6.59]  1%|          | 60/7420 [08:26<17:18:17,  8.46s/it, Loss=6.59]  1%|          | 60/7420 [08:34<17:18:17,  8.46s/it, Loss=6.2]   1%|          | 61/7420 [08:34<16:46:21,  8.21s/it, Loss=6.2]  1%|          | 61/7420 [08:41<16:46:21,  8.21s/it, Loss=6.39]  1%|          | 62/7420 [08:41<16:17:32,  7.97s/it, Loss=6.39]  1%|          | 62/7420 [08:50<16:17:32,  7.97s/it, Loss=6.14]  1%|          | 63/7420 [08:50<16:27:19,  8.05s/it, Loss=6.14]  1%|          | 63/7420 [08:57<16:27:19,  8.05s/it, Loss=6.59]  1%|          | 64/7420 [08:57<16:13:57,  7.94s/it, Loss=6.59]  1%|          | 64/7420 [09:05<16:13:57,  7.94s/it, Loss=6.47]  1%|          | 65/7420 [09:05<16:00:18,  7.83s/it, Loss=6.47]  1%|          | 65/7420 [09:13<16:00:18,  7.83s/it, Loss=6.58]  1%|          | 66/7420 [09:13<16:01:37,  7.85s/it, Loss=6.58]  1%|          | 66/7420 [09:21<16:01:37,  7.85s/it, Loss=6.49]  1%|          | 67/7420 [09:21<15:56:56,  7.81s/it, Loss=6.49]  1%|          | 67/7420 [09:28<15:56:56,  7.81s/it, Loss=6.61]  1%|          | 68/7420 [09:28<16:01:00,  7.84s/it, Loss=6.61]  1%|          | 68/7420 [09:36<16:01:00,  7.84s/it, Loss=5.79]  1%|          | 69/7420 [09:36<15:51:34,  7.77s/it, Loss=5.79]  1%|          | 69/7420 [09:44<15:51:34,  7.77s/it, Loss=6.26]  1%|          | 70/7420 [09:44<16:02:27,  7.86s/it, Loss=6.26]  1%|          | 70/7420 [09:52<16:02:27,  7.86s/it, Loss=6.51]  1%|          | 71/7420 [09:52<16:02:57,  7.86s/it, Loss=6.51]  1%|          | 71/7420 [10:00<16:02:57,  7.86s/it, Loss=5.88]  1%|          | 72/7420 [10:00<16:11:18,  7.93s/it, Loss=5.88]  1%|          | 72/7420 [10:07<16:11:18,  7.93s/it, Loss=6.53]  1%|          | 73/7420 [10:07<15:46:14,  7.73s/it, Loss=6.53]  1%|          | 73/7420 [10:15<15:46:14,  7.73s/it, Loss=6.39]  1%|          | 74/7420 [10:15<15:45:10,  7.72s/it, Loss=6.39]  1%|          | 74/7420 [10:22<15:45:10,  7.72s/it, Loss=6.02]  1%|          | 75/7420 [10:22<15:18:51,  7.51s/it, Loss=6.02]  1%|          | 75/7420 [10:30<15:18:51,  7.51s/it, Loss=6.01]  1%|          | 76/7420 [10:30<15:30:01,  7.60s/it, Loss=6.01]  1%|          | 76/7420 [10:37<15:30:01,  7.60s/it, Loss=6.08]  1%|          | 77/7420 [10:37<15:20:13,  7.52s/it, Loss=6.08]  1%|          | 77/7420 [10:45<15:20:13,  7.52s/it, Loss=6.19]  1%|          | 78/7420 [10:45<15:34:08,  7.63s/it, Loss=6.19]  1%|          | 78/7420 [10:50<15:34:08,  7.63s/it, Loss=6.39]  1%|          | 79/7420 [10:50<13:54:56,  6.82s/it, Loss=6.39]  1%|          | 79/7420 [10:55<13:54:56,  6.82s/it, Loss=6.4]   1%|          | 80/7420 [10:55<12:46:47,  6.27s/it, Loss=6.4]  1%|          | 80/7420 [10:57<12:46:47,  6.27s/it, Loss=6.46]  1%|          | 81/7420 [10:57<9:53:15,  4.85s/it, Loss=6.46] Epoch: 70, Loss Train: 6.3631

04/29/2025 19:17:37 - INFO - __main__ - {'epoch': 71, 'step': 81, 'train_loss': 6.3631}
04/29/2025 19:17:37 - INFO - accelerate.accelerator - Saving current state to /scratch/network/ms1438/output_test_new/epoch_71
04/29/2025 19:17:39 - INFO - accelerate.checkpointing - Model weights saved in /scratch/network/ms1438/output_test_new/epoch_71/pytorch_model.bin
04/29/2025 19:17:41 - INFO - accelerate.checkpointing - Optimizer state saved in /scratch/network/ms1438/output_test_new/epoch_71/optimizer.bin
04/29/2025 19:17:41 - INFO - accelerate.checkpointing - Scheduler state saved in /scratch/network/ms1438/output_test_new/epoch_71/scheduler.bin
04/29/2025 19:17:41 - INFO - accelerate.checkpointing - Gradient scaler state saved in /scratch/network/ms1438/output_test_new/epoch_71/scaler.pt
04/29/2025 19:17:41 - INFO - accelerate.checkpointing - Random states saved in /scratch/network/ms1438/output_test_new/epoch_71/random_states_0.pkl
  1%|          | 81/7420 [11:24<9:53:15,  4.85s/it, Loss=5.66]  1%|          | 82/7420 [11:24<23:34:00, 11.56s/it, Loss=5.66]  1%|          | 82/7420 [11:31<23:34:00, 11.56s/it, Loss=6.18]  1%|          | 83/7420 [11:31<20:58:07, 10.29s/it, Loss=6.18]  1%|          | 83/7420 [11:40<20:58:07, 10.29s/it, Loss=6.02]  1%|          | 84/7420 [11:40<19:53:43,  9.76s/it, Loss=6.02]  1%|          | 84/7420 [11:47<19:53:43,  9.76s/it, Loss=6.42]  1%|          | 85/7420 [11:47<18:34:21,  9.12s/it, Loss=6.42]  1%|          | 85/7420 [11:54<18:34:21,  9.12s/it, Loss=6.41]  1%|          | 86/7420 [11:54<17:18:16,  8.49s/it, Loss=6.41]  1%|          | 86/7420 [12:03<17:18:16,  8.49s/it, Loss=5.88]  1%|          | 87/7420 [12:03<17:10:35,  8.43s/it, Loss=5.88]  1%|          | 87/7420 [12:10<17:10:35,  8.43s/it, Loss=6.37]  1%|          | 88/7420 [12:10<16:39:00,  8.18s/it, Loss=6.37]  1%|          | 88/7420 [12:17<16:39:00,  8.18s/it, Loss=6.21]  1%|          | 89/7420 [12:17<16:08:11,  7.92s/it, Loss=6.21]  1%|          | 89/7420 [12:25<16:08:11,  7.92s/it, Loss=5.73]  1%|          | 90/7420 [12:25<16:04:16,  7.89s/it, Loss=5.73]  1%|          | 90/7420 [12:32<16:04:16,  7.89s/it, Loss=6.36]  1%|          | 91/7420 [12:32<15:38:50,  7.69s/it, Loss=6.36]  1%|          | 91/7420 [12:41<15:38:50,  7.69s/it, Loss=5.94]  1%|          | 92/7420 [12:41<15:56:23,  7.83s/it, Loss=5.94]  1%|          | 92/7420 [12:49<15:56:23,  7.83s/it, Loss=6.2]   1%|â–         | 93/7420 [12:49<15:57:43,  7.84s/it, Loss=6.2]  1%|â–         | 93/7420 [12:56<15:57:43,  7.84s/it, Loss=6.14]  1%|â–         | 94/7420 [12:56<16:00:15,  7.86s/it, Loss=6.14]  1%|â–         | 94/7420 [13:04<16:00:15,  7.86s/it, Loss=6.19]  1%|â–         | 95/7420 [13:04<15:37:49,  7.68s/it, Loss=6.19]  1%|â–         | 95/7420 [13:11<15:37:49,  7.68s/it, Loss=5.82]  1%|â–         | 96/7420 [13:11<15:41:21,  7.71s/it, Loss=5.82]  1%|â–         | 96/7420 [13:20<15:41:21,  7.71s/it, Loss=6.29]  1%|â–         | 97/7420 [13:20<15:55:24,  7.83s/it, Loss=6.29]  1%|â–         | 97/7420 [13:28<15:55:24,  7.83s/it, Loss=6.2]   1%|â–         | 98/7420 [13:28<16:17:37,  8.01s/it, Loss=6.2]  1%|â–         | 98/7420 [13:35<16:17:37,  8.01s/it, Loss=6.23]  1%|â–         | 99/7420 [13:35<15:49:41,  7.78s/it, Loss=6.23]  1%|â–         | 99/7420 [13:43<15:49:41,  7.78s/it, Loss=5.44]  1%|â–         | 100/7420 [13:43<15:48:00,  7.77s/it, Loss=5.44]  1%|â–         | 100/7420 [13:50<15:48:00,  7.77s/it, Loss=6.19]  1%|â–         | 101/7420 [13:50<15:36:31,  7.68s/it, Loss=6.19]  1%|â–         | 101/7420 [13:58<15:36:31,  7.68s/it, Loss=5.8]   1%|â–         | 102/7420 [13:58<15:40:10,  7.71s/it, Loss=5.8]  1%|â–         | 102/7420 [14:07<15:40:10,  7.71s/it, Loss=5.99]  1%|â–         | 103/7420 [14:07<16:02:05,  7.89s/it, Loss=5.99]  1%|â–         | 103/7420 [14:14<16:02:05,  7.89s/it, Loss=5.41]  1%|â–         | 104/7420 [14:14<15:51:40,  7.80s/it, Loss=5.41]  1%|â–         | 104/7420 [14:22<15:51:40,  7.80s/it, Loss=6.04]  1%|â–         | 105/7420 [14:22<15:55:24,  7.84s/it, Loss=6.04]  1%|â–         | 105/7420 [14:27<15:55:24,  7.84s/it, Loss=5.8]   1%|â–         | 106/7420 [14:27<14:11:58,  6.99s/it, Loss=5.8]  1%|â–         | 106/7420 [14:32<14:11:58,  6.99s/it, Loss=6.08]  1%|â–         | 107/7420 [14:32<13:01:45,  6.41s/it, Loss=6.08]  1%|â–         | 107/7420 [14:34<13:01:45,  6.41s/it, Loss=6]     1%|â–         | 108/7420 [14:34<9:58:59,  4.92s/it, Loss=6] Epoch: 71, Loss Train: 5.9522

04/29/2025 19:21:14 - INFO - __main__ - {'epoch': 72, 'step': 108, 'train_loss': 5.9522}
04/29/2025 19:21:14 - INFO - accelerate.accelerator - Saving current state to /scratch/network/ms1438/output_test_new/epoch_72
04/29/2025 19:21:16 - INFO - accelerate.checkpointing - Model weights saved in /scratch/network/ms1438/output_test_new/epoch_72/pytorch_model.bin
04/29/2025 19:21:18 - INFO - accelerate.checkpointing - Optimizer state saved in /scratch/network/ms1438/output_test_new/epoch_72/optimizer.bin
04/29/2025 19:21:18 - INFO - accelerate.checkpointing - Scheduler state saved in /scratch/network/ms1438/output_test_new/epoch_72/scheduler.bin
04/29/2025 19:21:18 - INFO - accelerate.checkpointing - Gradient scaler state saved in /scratch/network/ms1438/output_test_new/epoch_72/scaler.pt
04/29/2025 19:21:18 - INFO - accelerate.checkpointing - Random states saved in /scratch/network/ms1438/output_test_new/epoch_72/random_states_0.pkl
slurmstepd: error: *** JOB 2447374 ON adroit-h11g3 CANCELLED AT 2025-04-29T19:21:34 DUE TO TIME LIMIT ***
